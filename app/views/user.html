<div ng-include src="'views/searchnav.html'"></div> 
  
<div id="not-found" ng-if="notfound" ng-include src="'views/not-found.html'"></div>
<div class="main-content" id="home-page">
  
  <div ng-if="!notfound" class="content" layout="column" ng-cloak>

    <div ng-include src="'views/sidenav.html'" id="fixed-sidebar"></div>

    <div ng-if="noSubs" align="center" class="banner-div" id="not-found-div">
      <h3 class="sub-banner">{{ username }} does not have any activity yet.</h3>
      <br>
    </div>

    <div ng-if="!noSubs" class="banner-div">
      <div class="user-banner sub-banner row">
        <div class="col-md-8 col-md-push-3 user-page">
          <div class="row">
            <div class="col-sm-7">
              <span class="reddit-name shadow-text"><span class="baby-blue">/u/</span>{{ username }}</span>
            </div>
            <div class="col-sm-5 badge-col">
              <span class="badge num-subs">{{ subLength }} <ng-pluralize count="subLength" when="{'1': 'subreddit', 'other': 'subreddits'}"></ng-pluralize></span>
            </div>
          </div>
          <div class="row banner-subtext">
            <div class="col-md-6 col-xs-12">
              <strong class="white shadow-text">Redditor since: <span class="bright-blue" ng-bind="redditor.created_utc * 1000 | amDateFormat: 'MMMM Do YYYY, h:mm a'"></span></strong>
            </div>
            <div class="col-md-6 col-xs-12 right-box">
              <div class="shadow-text"><i class="fa fa-clock-o" aria-hidden="true"></i> <strong class="white">Last seen: <time-ago class="bright-blue" from-time='{{ lastPost.created_utc * 1000 }}'></time-ago></strong></div>
            </div>
          </div>
        </div>
      </div>
      
        <div class="user-head-nav">
          <div class="col-xs-3" align="right" ng-click="scrollAnchor('subreddits')"><p>Subs</p></div>
          <div class="col-xs-6" align="center" ng-click="scrollAnchor('latest')"><p>Recent Activity</p></div>
          <div class="co-xs-3" align="left" ng-click="scrollAnchor('statistics')"><p>Statisics</p></div>
        </div>

        <div class="sub-table">
          <div ng-include src="'views/user-sidebar.html'"></div>
          <div class="col-md-8 col-md-push-3 col-xs-12 sub-rows" id="table-head">

            <div id="subreddits">
              <div class="row">
                <div class="col-md-9 col-sm-12 col-xs-12 dropdown-col">
                  <div class="btn-group select-dropdown">
                    <button type="button" class="form-control btn btn-default dropdown-toggle" data-toggle="dropdown">
                      {{ selected.name }}
                    </button>
                    <ul class="dropdown-menu" role="menu">
                      <li ng-repeat="sort in sortData.sortOptions" ng-click="setSortOption(sort)">{{ sort.name }}</li>
                    </ul>
                </div>
                </div>
                <div class="col-md-3 hidden-sm hidden-xs option-pos" align="right">
                  <form>
                    <md-input-container>
                      <label for="testInput" class="main-color low-weight"><i class="glyphicon glyphicon-search" aria-hidden="true"></i> Search for a sub</label>
                      <input type="text" id="testInput"
                             ng-model="searchSub" ng-change="changeSubs(searchSub)" md-autofocus>
                    </md-input-container>
                    <button type="submit" style="display: none;" ng-controller="SidebarCtrl" ng-click="close()">Go!</button>
                  </form>
                </div>
              </div>      
              <br>

              <div class="card" ng-repeat="subreddit in subList.slice(0, currentLimit)" id="sub-row">
                <div class="card-content row">
                  <a ng-href="#/{{ username }}/{{ subreddit }}/">
                  <div class="col-md-6" id="sub-rank">
                    <div class="col-md-2">
                      <span class="baby-blue"><strong>{{ 1 + $index }}</strong></span>
                    </div>
                    <div class="col-md-10">
                      <span id="sub-name"> /r/{{ subreddit }}</span><br>
                      <span class="gray sub-text">Last seen <span ng-bind="subs[subreddit].recent_activity.created_utc * 1000 | amDateFormat:'MMM Do YYYY, h:mm a'"></span></span>
                    </div>
                  </div>
                  <div class="col-md-2 col-xs-4" id="sub-comments" align="center">
                    <span class="black number">{{ subs[subreddit].comments.length }}</span><br>
                    <span class="gray sub-text">Comments</span>
                  </div>
                  <div class="col-md-2 col-xs-4" id="sub-submits" align="center">
                    <span class="black number">{{ subs[subreddit].submissions.length }}</span><br>
                    <span class="gray sub-text">Submitted</span>
                  </div>
                  <div class="col-md-2 col-xs-4" id="sub-upvotes" align="center">
                    <span class="number" ng-class="subs[subreddit].total_ups > 0 ? 'green' : 'orange'">{{ subs[subreddit].total_ups | number }}</span><br>
                    <span class="gray sub-text">Upvotes</span>
                  </div>
                  </a>
                </div>
              </div>
            </div>

            <div ng-if="(currentLimit > limit) || (currentLimit == limit && subList.length > limit)" class="card" align="center" id="more-subs" ng-click="changeLimit()">
              <div class="card-content">
                <span>{{ currentLimit == subLength ? 'See less subreddits' : 'See more subreddits' }} <i class="fa" ng-class="currentLimit == subLength ? 'fa-angle-up' : 'fa-angle-down'" aria-hidden="true"></i></span>
              </div>
            </div>

            <br><br>
            <div id="latest">
              <div ng-repeat="element in latest" ng-if="element.id">
                <div class="card side-cards">
                  <div class="card-content card-heading">
                    <i class="fa fa-calendar purple" aria-hidden="true"></i> {{ element.type == 'comment' ? 'Most Recent Comment' : 'Most Recent Submission' }} (<span class="green">r/{{ element.subreddit }}</span>)
                  </div>
                </div>
                <div ng-if="element.type == 'comment'">
                  <div ng-include src="'views/comment.html'"></div>
                </div>
                <div ng-if="element.type == 'submit'">
                  <div ng-include src="'views/submission.html'"></div>
                </div>
              </div>
            </div>

            <br>
            <div id="statistics" ng-controller="UserStatsCtrl">
              <div class="row badge-row small-font" id="user-badges">
                <div class="col-sm-3 col-xs-6" align="center">
                  <img ng-src="{{ '../images/active.png' }}" class="stat-icon"><br>
                  <strong class="green">Most Active Sub</strong><br>
                  <a ng-href="https://www.reddit.com/r/{{ mostActive }}" target="_blank"><strong><i class="fa fa-shield" aria-hidden="true"></i> r/{{ mostActive }}</strong></a>
                </div>
                <div class="col-sm-3 col-xs-6" align="center">
                  <img ng-src="{{ '../images/best.png' }}" class="stat-icon"><br>
                  <strong class="green">Most Upvoted Sub</strong><br>
                  <a ng-href="https://www.reddit.com/r/{{ mostUpvoted }}" target="_blank"><strong><i class="fa fa-shield" aria-hidden="true"></i> r/{{ mostUpvoted }}</strong></a>
                </div>
                <div class="col-sm-3 col-xs-6" align="center">
                  <img ng-src="{{ '../images/worst.png' }}" class="stat-icon"><br>
                  <strong class="green">Least Upvoted Sub</strong><br>
                  <a ng-href="https://www.reddit.com/r/{{ leastUpvoted}}" target="_blank"><strong><i class="fa fa-shield" aria-hidden="true"></i> r/{{ leastUpvoted }}</strong></a>
                </div> 
                <div class="col-sm-3 col-xs-6" align="center">
                  <img ng-src="{{ '../images/new.png' }}" class="stat-icon"><br>
                  <strong class="green">Newest Active Sub</strong><br>
                  <a ng-href="https://www.reddit.com/r/{{ newestSub }}" target="_blank"><strong><i class="fa fa-shield" aria-hidden="true"></i> r/{{ newestSub }}</strong></a>
                </div>  
              </div>          

              <br>
              <div ng-controller="PiechartCtrl" align="center">
                <div class="col-md-6 col-xs-12 pie-box-left" align="center">
                  <div ng-if="comments > 0">
                    <h4><strong>Subreddit distribution across<br><span class="baby-blue">{{ username }}'s</span><br>most recent {{ chartLimit }} comments</strong></h4>
                    <span class="small-font">Hover to see the number of comments for that sub out of {{ username }}'s most recent {{ chartLimit }} comments.</span>
                    <donut-chart type="comments" limit="20" align="center"></donut-chart>
                    <h5 ng-if="comments == 0">{{ username }} does not have any comments.</h5>
                  </div>
                </div>
                <div class="col-md-6 col-xs-12 pie-box-right" align="center">
                  <div ng-if="submissions > 0">
                    <h4><strong>Subreddit distribution across<br><span class="baby-blue">{{ username }}'s</span><br>most recent {{ chartLimit }} submissions</strong></h4>
                    <span class="small-font">Hover to see the number of submissions for that sub out of {{ username }}'s most recent {{ chartLimit }} submissions.</span>
                    <donut-chart type="submissions" limit="20" align="center"></donut-chart>
                    <h5 ng-if="submissions == 0">{{ username }} does not have any submissions.</h5> 
                  </div>  
                </div>
              </div>
            </div>
            <div align="center" class="center-back">
              <back-top></back-top>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>